<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="fontawesome/css/all.css">
    <link rel="stylesheet" href="CSS/register.css">
    <link rel="icon" href="Images/icon.png">

    <title>Registrazione</title>
</head>
<nav class="navbar navbar-expand-lg navbar-dark sticky-top">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="nav flex-column nav-pills nav-fill">
            <li class="nav-item">
                <a class="nav-link active" href="#account_hash">Account</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#anagrafica_hash">Dati Anagrafici</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#indirizzo_hash">Indirizzo</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#concludi_hash">Registrati</a>
            </li>
        </ul>
    </div>
</nav>
<body data-spy="scroll" data-target=".navbar" data-offset="90">
        <div class="section" id="account_hash">
            <div class="centered">
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" class="form-control" id="email_input" onchange="validateMail()" required>
                    <div class="invalid-feedback" id="email_feedback">
                        Inserire un indirizzo email valido
                    </div>
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <div class="input-group">
                        <input type="password" class="form-control" id="password_input" onchange="validatePassword()" required>
                        <div class="input-group-prepend">
                            <div class="input-group-text" style="max-height: 38px;">
                                <button onclick="toggle('password_input')" style="border:none;outline:none;height:20px;width:30px; background-color: transparent;">
                                    <i class="fas fa-eye" id="password_input_icon"></i>
                                </button>
                            </div>
                        </div>
                        <div class="invalid-feedback" id="password_feedback">
                            La password deve contenere un minimo di 8 caratteri tra cui almeno un numero, una lettera maiuscola e una minuscola.
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Username:</label>
                    <input type="text" class="form-control" id="username_input" onchange="validate1()" required>
                    <div class="invalid-feedback" id="username_feedback">
                        Inserire un nome utente
                    </div>
                </div>
                <button id = "next_1" type="submit" class="btn btn-primary" onclick="next1()">Avanti</button>
            </div>
        </div>
        <div class="section" id="anagrafica_hash">
            <div class="centered">
                <div class="form-group">
                    <label>Nome:</label>
                    <input type="text" class="form-control" id="nome_input" onchange="validateEmpty('nome_input')" required>
                    <div class="invalid-feedback" id="nome_feedback">
                        Inserisci il tuo nome
                    </div>
                </div>
                <div class="form-group">
                    <label>Cognome:</label>
                    <input type="text" class="form-control" id="cognome_input" onchange="validateEmpty('cognome_input')" required>
                    <div class="invalid-feedback" id="cognome_feedback">
                        Inserisci il tuo cognome
                    </div>
                </div>
                <div class="form-group">
                    <label>Data di nascita:</label>
                    <input type="Date" class="form-control" id="dataNascita_input" onchange="validateEmpty('dataNascita_input')" required>
                    <div class="invalid-feedback" id="dataNascita_feedback">
                        Inserisci il tuo cognome
                    </div>
                </div>
                <div class="form-group">
                    <label>Sesso:</label>
                    <select class="form-control" type="text" id="sesso_input" onchange="validateEmpty('sesso_input')" required>
                        <option value="1">M</option>
                        <option value="2">F</option>
                    </select>
                    <div class="invalid-feedback" id="sesso_feedback">
                        Seleziona un'opzione
                    </div>
                </div>
                <button id = "next_2" type="submit" class="btn btn-primary" onclick="next2()">Avanti</button>
            </div>
            
        </div>
        <div class="section" id="indirizzo_hash">
            <div class="centered">
                <div class="form-group">
                    <div class="row">
                        <div class="col-md-9">
                            <label>Via:</label>
                            <input type="text" class="form-control" onchange="validate_charonly('via_input')" id="via_input" required>
                        </div>
                        <div class="col-md-3">
                            <label>Civico:</label>
                            <input type="text" class="form-control" onchange="validate_civico()" id="civico_input" required>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <div class="col-md-5">
                            <label>Citt√†:</label>
                            <input type="text" class="form-control" id="citta_input" onchange="validate_charonly('citta_input')" required>
                        </div>
                        <div class="col-md-4">
                            <label>Provincia:</label>
                            <input type="text" class="form-control" id="provincia_input" onchange="validate_charonly('provincia_input')" required>
                        </div>
                        <div class="col-md-3">
                            <label>CAP:</label>
                            <input type="text" class="form-control" id="CAP_input" onchange="validate_cap()" required>
                        </div>
                    </div>
                </div>
                <button id = "next_3" type="submit" class="btn btn-primary" onclick="next3()">Avanti</button>
            </div>
        </div>
        <div class="section" id="concludi_hash">
            <div class="centered" style="text-align: center;width:100%; height: 100%;">
                <button class="register_button btn" onclick="submit()" style="width:100%; height:100%;background-color: rgba(0, 0, 0, 0.568); color:rgba(255, 255, 255, 0.829)"><i class="fas fa-check fa-9x"></i></button>
                <p class="error" id="serverResponse"></p>
            </div>
            
        </div>

      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
      <script src="Scrollify/jquery.scrollify.js" type="text/javascript"></script>
      <script>
        $(function() {
          $.scrollify({
            section : ".section",
            scrollbars: true,
            setHeights: true,
            overflowScroll: true,
            updateHash: false,
            touchScroll: true
          });
        });
      </script>
      <script src="bootstrap/js/bootstrap.min.js"></script>
      <script src="smooth-scroll-master/dist/smooth-scroll.polyfills.min.js"></script>
        <script>var scroll = new SmoothScroll('a[href*="#"]');</script>
      <script src="Scripts/register.js" type="text/javascript"></script>
      <script src="Scripts/password_toggler.js" type="text/javascript"></script>
      <script>
        var password_input = document.getElementById("password_input");
        var email_input = document.getElementById("email_input");
        var username_input = document.getElementById("username_input");

        var next_1 = document.getElementById("next_1");

        password_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_1.click();
        }
        });
        email_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_1.click();
        }
        });
        username_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_1.click();
        }
        });
        function validateMail(){
            var email = email_input.value;
            if(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.exec(email)){
                email_input.className = "form-control is-valid";
                return true;
            }
            else{
                email_input.className = "form-control is-invalid";
                return false;
            }
        }
        function validatePassword(){
            var password = password_input.value;
            if(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.exec(password)){
                password_input.className = "form-control is-valid";
                return true;
            }
            else{
                password_input.className = "form-control is-invalid";
                return false;
            }
        }
        function validate1(){
            var password = password_input.value;
            var email = email_input.value;
            var username = username_input.value;
            if(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.exec(email)){
                email_input.className = "form-control is-valid";
                if(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.exec(password)){
                    password_input.className = "form-control is-valid";
                    if(username!=""){
                        username_input.className = "form-control is-valid";
                        return true;
                    }
                    else{
                        username_input.className = "form-control is-invalid";
                        return false;
                    }
                }
                else{
                    password_input.className = "form-control is-invalid";
                    return false;
                }
            }
            else{
                email_input.className = "form-control is-invalid";
                return false;
            }
            
        }
        var nome_input = document.getElementById("nome_input");
        var cognome_input = document.getElementById("cognome_input");
        var datanascita_input = document.getElementById("dataNascita_input");
        var sesso_input = document.getElementById("sesso_input");

        var next_2 = document.getElementById("next_2");

        nome_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_2.click();
        }
        });
        cognome_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_2.click();
        }
        });
        datanascita_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_2.click();
        }
        });
        sesso_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_2.click();
        }
        });
        function validateEmpty(input_name){
            var input = document.getElementById(input_name);
            if(input.value!=""){
                input.className = "form-control is-valid";
                return true;
            }
            else{
                input.className = "form-control is-invalid";
                return false;
            }
        }
        function validate2(){
            var nome = nome_input.value;
            var cognome = cognome_input.value;
            var datanascita = datanascita_input.value;
            var sesso = sesso_input.value;

            if(nome!=""){
                nome_input.className = "form-control is-valid";
                if(cognome!=""){
                    cognome_input.className = "form-control is-valid";
                    if(datanascita!=""){
                        datanascita_input.className = "form-control is-valid";
                        if(sesso!=""){
                            sesso_input.className = "form-control is-valid";
                            return true;
                        }
                        else{
                            sesso_input.className = "form-control is-invalid";
                            return false;
                        }
                    }
                    else{
                        datanascita_input.className = "form-control is-invalid";
                        return false;
                    }
                }
                else{
                    cognome_input.className = "form-control is-invalid";
                    return false;
                }
            }
            else{
                nome_input.className = "form-control is-invalid";
                return false;
            }
            
        }
        var via_input = document.getElementById("via_input");
        var civico_input = document.getElementById("civico_input");
        var citta_input = document.getElementById("citta_input");
        var provincia_input = document.getElementById("provincia_input");
        var cap_input = document.getElementById("CAP_input");

        var next_3 = document.getElementById("next_3");
        via_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_3.click();
        }
        });
        civico_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_3.click();
        }
        });
        citta_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_3.click();
        }
        });
        provincia_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_3.click();
        }
        });
        cap_input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            next_3.click();
        }
        });
        function validate_charonly(input_name){
            var input = document.getElementById(input_name);
            if((/^[a-zA-Z ]+$/.exec(input.value))){
                input.className = "form-control is-valid";
                return true;
            }
            else{
                input.className = "form-control is-invalid";
                return false;
            }
        }
        function validate_civico(){
            if(/^[0-9]{1,3}([\/]?)([a-z]?)([0-9]?){1,3}$/.exec(civico_input.value)){
                civico_input.className = "form-control is-valid";
                return true;
            }
            else{
                civico_input.className = "form-control is-invalid";
                return false;
            }
        }
        function validate_cap(){
            if(/^[0-9]{5,5}$/.exec(cap_input.value)){
                cap_input.className = "form-control is-valid";
                return true;
            }
            else{
                cap_input.className = "form-control is-invalid";
                return false;
            }
        }
        function next1(){
            if(validate1()){
                location.hash = "#anagrafica_hash";
            }
        }
        function next2(){
            if(validate2()){
                location.hash = "#indirizzo_hash";
            }
        }
        function next3(){
            if(validate_cap() && validate_civico() && validate_charonly("via_input") && validate_charonly("citta_input") && validate_charonly("provincia_input")){
                location.hash = "#concludi_hash";
            }
        }
      </script>

</body>
</html>